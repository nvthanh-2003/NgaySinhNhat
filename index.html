<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G·ª≠i l·ªùi ch√∫c n√†y ƒë·∫øn ng∆∞·ªùi quan tr·ªçng! üéÇ</title>
    <!-- T·∫£i Tailwind CSS ƒë·ªÉ t·∫°o giao di·ªán hi·ªán ƒë·∫°i -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Thi·∫øt l·∫≠p n·ªÅn v√† cƒÉn gi·ªØa */
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%); /* H·ªìng nh·∫°t, ·∫•m √°p */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            /* ƒê·∫∑t overflow: auto; ƒë·ªÉ ƒë·∫£m b·∫£o n·ªôi dung kh√¥ng b·ªã c·∫Øt n·∫øu qu√° l·ªõn,
               nh∆∞ng t√¥i v·∫´n gi·ªØ hidden ƒë·ªÉ duy tr√¨ hi·ªáu ·ª©ng ph√°o hoa to√†n m√†n h√¨nh */
            overflow: hidden;
            color: #4a4a4a;
        }
        #greetingCard {
            background-color: #ffffff;
            border-radius: 24px; /* G√≥c bo tr√≤n h∆°n */
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
            padding: 3rem 2rem;
            max-width: 450px; /* Gi·ªõi h·∫°n k√≠ch th∆∞·ªõc thi·ªáp */
            width: 90%;
            text-align: center;
            position: relative;
            z-index: 10;
        }
        #title {
            color: #e90064; /* M√†u h·ªìng ƒë·∫≠m */
            font-weight: 900;
            font-size: 2.25rem;
            margin-bottom: 2.5rem;
            text-shadow: 1px 1px 3px rgba(255, 192, 203, 0.5);
        }

        /* Th√™m CSS n√†y ƒë·ªÉ ƒë·∫£m b·∫£o video lu√¥n n·∫±m trong gi·ªõi h·∫°n c·ªßa #greetingCard */
        #videoContainer video {
            width: 100%;
            height: auto;
            display: block;
            max-width: 100%;
        }

        /* ·∫®n/Hi·ªán message v√† video */
        #message {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 1.5s ease-in-out, transform 1s ease-out;
            text-align: left;
        }
        #message.visible {
            opacity: 1;
            transform: translateY(0);
        }
        #videoContainer {
            transition: opacity 0.5s ease-in-out;
        }
        .hidden-element {
            display: none;
        }

        #personImage {
            width: 120px;
            height: 120px;
            object-fit: cover;
            border-radius: 50%;
            border: 4px solid #fbcfe8;
            margin: 0 auto 1.5rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            display: block;
        }
        .signature {
            margin-top: 1.5rem;
            font-style: italic;
            font-weight: 600;
            color: #e90064;
            text-align: right;
        }
        .emoji-section {
            margin: 2rem 0;
            font-size: 2rem;
            display: flex;
            justify-content: space-around;
        }
        #showButton {
            transition: all 0.3s ease;
            transform: scale(1);
        }
        #showButton:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(233, 0, 100, 0.4);
        }

        /* V·ªã tr√≠ Canvas Confetti */
        #confetti {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 5;
        }
    </style>
</head>
<body>

<div id="greetingCard" class="shadow-xl">
    <h1 id="title">Ch√∫c m·ª´ng sinh nh·∫≠t em!</h1>

    <!-- 1. CONTAINER VIDEO (·∫®n ban ƒë·∫ßu) -->
    <div id="videoContainer" class="hidden-element rounded-xl overflow-hidden mb-4">
        <!-- ƒê√£ lo·∫°i b·ªè width="100%" height="auto" ·ªü ƒë√¢y v√† thay th·∫ø b·∫±ng CSS ƒë·ªÉ ki·ªÉm so√°t t·ªët h∆°n -->
        <video id="birthdayVideo" controls>
            <!-- IMPORTANT: Thay th·∫ø li√™n k·∫øt n√†y b·∫±ng URL video c√¥ng khai c·ªßa b·∫°n -->
            <source src="7286179828977.mp4" type="video/mp4">
            Tr√¨nh duy·ªát c·ªßa b·∫°n kh√¥ng h·ªó tr·ª£ th·∫ª video.
        </video>
    </div>


    <!-- 2. N·ªòI DUNG THI·ªÜP (·∫®n ban ƒë·∫ßu) -->
    <div id="message" class="hidden-element">
        <img id="personImage" src="anh2.jpg" alt="Ng∆∞·ªùi t√¥i y√™u" class="mx-auto">

        <p class="mb-3">G·ª≠i t·ªõi em,</p>
        <p class="mb-3 leading-relaxed">G·ª≠i l·ªùi ch√∫c t·ªët ƒë·∫πp nh·∫•t ƒë·∫øn m·ªôt ng∆∞·ªùi xinh ƒë·∫πp v√† l√† ng∆∞·ªùi tr√¢n tr·ªçng nh·∫•t ƒë·ªëi v·ªõi anh! Ch√∫c em sinh nh·∫≠t th·∫≠t ·∫•m √°p v√† h·∫°nh ph√∫c nh√©. Ch√∫c em tu·ªïi m·ªõi lu√¥n r·∫°ng r·ª°, h·∫°nh ph√∫c, v√† ƒë·∫°t ƒë∆∞·ª£c m·ªçi ƒëi·ªÅu m√¨nh mong mu·ªën. Tuy ·ªü xa kh√¥ng ƒë√≥n sinh nh·∫≠t ƒë∆∞·ª£c c√πng nh∆∞ng v·∫´n mong nh·ªØng ƒëi·ªÅu tuy·ªát v·ªùi ƒë∆∞·ª£c g·ª≠i ƒë·∫øn v·ªõi em</p>
        <p class="signature">Ng√†y tuy·ªát v·ªùi nh·∫•t!</p>

        <div class="emoji-section">
            <span>üíñ</span>
            <span>üéâ</span>
            <span>üéÇ</span>
            <a href="ToTinh.html">üéÅ</a>
        </div>
    </div>

    <!-- 3. N√öT M·ªû QU√Ä -->
    <button id="showButton" onclick="revealMessage()"
            class="mt-6 px-8 py-3 bg-pink-500 text-white font-bold rounded-full shadow-lg hover:bg-pink-600 focus:outline-none focus:ring-4 focus:ring-pink-300 transition duration-300 ease-in-out">
        Nh·∫•p v√†o ƒë√¢y ƒë·ªÉ m·ªü qu√†
    </button>
</div>

<canvas id="confetti"></canvas>

<script>
    // ƒê·ªãnh nghƒ©a c√°c bi·∫øn DOM
    const message = document.getElementById('message');
    const showButton = document.getElementById('showButton');
    const videoContainer = document.getElementById('videoContainer');
    const birthdayVideo = document.getElementById('birthdayVideo');

    // Kh·ªüi t·∫°o Canvas Confetti
    const canvas = document.getElementById('confetti');
    const ctx = canvas.getContext('2d');
    let particles = [];
    const colors = ['#f44336', '#e91e63', '#9c27b0', '#673ab7', '#3f51b5', '#2196f3', '#00bcd4', '#009688', '#4caf50', '#8bc34a', '#ffeb3b', '#ffc107', '#ff9800', '#ff5722'];

    // C·∫•u h√¨nh Confetti v√† Animation (gi·ªØ nguy√™n t·ª´ phi√™n b·∫£n tr∆∞·ªõc)
    function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    function ConfettiParticle() {
        this.x = canvas.width / 2;
        this.y = canvas.height / 2;
        this.radius = Math.random() * 8 + 2;
        this.color = colors[Math.floor(Math.random() * colors.length)];
        this.tilt = Math.floor(Math.random() * 10) - 10;
        this.tiltAngle = 0;
        this.tiltAngleIncrement = Math.random() * 0.1 + 0.05;
        this.velocity = {
            x: (Math.random() - 0.5) * 15,
            y: (Math.random() * -18) - 5
        };
        this.gravity = 0.5;
        this.dampening = 0.9;
    }

    ConfettiParticle.prototype.update = function() {
        this.velocity.y += this.gravity;
        this.velocity.x *= this.dampening;
        this.x += this.velocity.x;
        this.y += this.velocity.y;
        this.tiltAngle += this.tiltAngleIncrement;
        this.tilt = Math.sin(this.tiltAngle) * 25;
    };

    ConfettiParticle.prototype.draw = function() {
        ctx.beginPath();
        ctx.lineWidth = this.radius * 2;
        ctx.strokeStyle = this.color;
        ctx.moveTo(this.x + this.tilt, this.y);
        ctx.lineTo(this.x, this.y + this.tilt);
        ctx.stroke();
    };

    function animateConfetti() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        particles = particles.filter(p => p.y < canvas.height);

        for (let i = 0; i < particles.length; i++) {
            particles[i].update();
            particles[i].draw();
        }

        // Ch·ªâ ti·∫øp t·ª•c animation n·∫øu c√≤n h·∫°t ph√°o hoa
        if (particles.length > 0) {
            requestAnimationFrame(animateConfetti);
        }
    }

    function shootConfetti() {
        const count = 75;
        for (let i = 0; i < count; i++) {
            particles.push(new ConfettiParticle());
        }
        animateConfetti();
    }

    // --- LOGIC CHO T∆Ø∆†NG T√ÅC THI·ªÜP ---

    // H√†m hi·ªÉn th·ªã th√¥ng ƒëi·ªáp v√† ph√°o hoa
    function showMessageAndConfetti() {
        // ·∫®n video v√† container
        videoContainer.classList.add('hidden-element');

        // Hi·ªÉn th·ªã th√¥ng ƒëi·ªáp
        message.classList.remove('hidden-element');
        setTimeout(() => {
            // ƒê·ª£i m·ªôt ch√∫t ƒë·ªÉ transition ho·∫°t ƒë·ªông m∆∞·ª£t m√†
            message.classList.add('visible');
        }, 100);

        // K√≠ch ho·∫°t ph√°o hoa
        shootConfetti();
    }

    // S·ª± ki·ªán khi video k·∫øt th√∫c
    birthdayVideo.addEventListener('ended', () => {
        showMessageAndConfetti();
    });

    // S·ª± ki·ªán khi ng∆∞·ªùi d√πng t·∫Øt video (b·∫•m n√∫t d·ª´ng ho·∫∑c tho√°t fullscreen)
    birthdayVideo.addEventListener('pause', () => {
        // N·∫øu video b·ªã d·ª´ng v√† ch∆∞a k·∫øt th√∫c, h·ªèi ng∆∞·ªùi d√πng c√≥ mu·ªën b·ªè qua kh√¥ng
        if (birthdayVideo.currentTime > 0 && birthdayVideo.currentTime < birthdayVideo.duration && !message.classList.contains('visible')) {
            // Thay th·∫ø cho alert()
            // S·ª≠ d·ª•ng m·ªôt modal t√πy ch·ªânh thay v√¨ window.confirm
            const confirmSkip = window.confirm('B·∫°n c√≥ mu·ªën b·ªè qua video v√† xem th√¥ng ƒëi·ªáp ch√∫c m·ª´ng kh√¥ng?');
            if (confirmSkip) {
                // T·∫Øt video v√† hi·ªÉn th·ªã th√¥ng ƒëi·ªáp
                birthdayVideo.pause();
                birthdayVideo.currentTime = 0;
                showMessageAndConfetti();
            } else {
                // Ti·∫øp t·ª•c ch∆°i video
                birthdayVideo.play().catch(e => console.error("Could not resume play:", e));
            }
        }
    });

    // H√†m ƒë∆∞·ª£c g·ªçi khi nh·∫•n n√∫t "M·ªü qu√†"
    function revealMessage() {
        // 1. ·∫®n n√∫t "M·ªü qu√†"
        showButton.classList.add('hidden-element');

        // 2. Hi·ªán container video v√† ph√°t video
        videoContainer.classList.remove('hidden-element');

        // Ch∆°i video (n·∫øu c√≥ ngu·ªìn h·ª£p l·ªá)
        if (birthdayVideo.src || birthdayVideo.querySelector('source') && birthdayVideo.querySelector('source').src) {
            // ƒê·∫£m b·∫£o video b·∫Øt ƒë·∫ßu t·ª´ ƒë·∫ßu
            birthdayVideo.currentTime = 0;

            // X·ª≠ l√Ω Autoplay
            birthdayVideo.play().catch(error => {
                console.warn("Autoplay b·ªã ch·∫∑n. Y√™u c·∫ßu ng∆∞·ªùi d√πng b·∫•m Play.");
                // Hi·ªÉn th·ªã th√¥ng b√°o n·∫øu Autoplay b·ªã ch·∫∑n
                const titleElement = document.getElementById('title');
                titleElement.textContent = "Nh·∫•n Play ƒë·ªÉ xem m√≥n qu√† ƒë·∫ßu ti√™n!";

                // Th√™m n√∫t Play th·ªß c√¥ng ƒë·ªÉ ng∆∞·ªùi d√πng t∆∞∆°ng t√°c
                const manualPlayButton = document.createElement('button');
                manualPlayButton.textContent = '‚ñ∂Ô∏è Xem Video';
                manualPlayButton.id = 'manualPlayButton';
                manualPlayButton.className = 'mt-4 px-6 py-2 bg-red-500 text-white font-semibold rounded-lg hover:bg-red-600 transition duration-300';
                manualPlayButton.onclick = () => {
                    birthdayVideo.play().then(() => {
                        manualPlayButton.remove();
                        titleElement.textContent = "Ch√∫c m·ª´ng sinh nh·∫≠t em!";
                    }).catch(e => console.error("L·ªói ph√°t video:", e));
                };
                videoContainer.after(manualPlayButton);
            });
        }

        // Ch·∫∑n s·ª± ki·ªán click l·∫∑p l·∫°i
        showButton.onclick = null;
    }
</script>

</body>
</html>